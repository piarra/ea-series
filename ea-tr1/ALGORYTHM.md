# TR1 アルゴリズム概要

- **タイプ**: トレンドフォロー型。方向は BUY / SELL の二択。
- **トレンド判定**: M1 足の終値を使った EMA クロスで判定 (初期値: Fast=20, Slow=50)。
  - FastEMA > SlowEMA → BUY トレンド。
  - FastEMA < SlowEMA → SELL トレンド。
- **初動エントリー**: EA 起動後またはノーポジ状態で、直近トレンド方向に同ロットの SWING / SCALP の 2 本を同時に成行建て。
- **利確 (ボラ連動)**:
  - 10秒合成足ベースで自前計算した ATR(Period=20) をポイント換算して利用。
  - SCALP: 含み益が ATR×0.4 に達したら成行クローズ。
  - SWING: 初期 TP を ATR×1.2 に設定し、建値到達後は SL を建値へ引き上げ。以降 ATR×0.8 の距離でトレーリングSLを更新（ブローカー制約を満たす場合のみ）。
- **損切り**: SCALP/SWING 共通で含み損が ATR×1.0 に達したら成行クローズ。SWING は建値+トレーリングで利を伸ばす。
- **逆転時の損切り**: エントリーから 3 本の 1 分足が経過 (≒180 秒) した後でトレンドが反転していれば即時成行決済。決済から 1 秒待機後、反対方向に 1 ポジション保有し直す。
- **ポジション管理**: MagicNumber で自 EA のポジションのみを管理。常に同方向 SWING/SCALP ペア構成。ナンピン・追撃は行わない。
- **その他**: スプレッドが上限を超える場合はエントリーを見送る。SL/TP は価格指定せず、リアルタイム判定でクローズする（TPは必要時に都度設定）。
